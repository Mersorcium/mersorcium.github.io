<div class="section">
    <h1 class="section-title underline">News</h1>
    <p class="seminar-title"><span class="newstype">Online Seminar</span> Unveiling the role of phytoplankton species in mercury cycling transformations</p>
    <p><span class="newstype">Speaker:</span> JoÃ£o Santos</p>

    <!-- ðŸ•’ Seminar Time (local) -->
    <div class="seminar-time-box">
        <strong>ðŸ•’ Seminar Time:</strong>
        <div id="seminar-time">Loading local time...</div>
        <small style="color: gray;">Automatically converted to your local timezone</small>
            <!-- ðŸ“… Add to Calendar Buttons -->
        <div class="calendar-buttons" style="margin-top: 1em;">
            <a id="gcal-link" class="calendar-button" target="_blank">âž• Add to Google Calendar</a>
            <a id="ics-download" class="calendar-button" download="seminar.ics">ðŸ“¥ Add to Outlook / iCal</a>
        </div>
    </div>



    <!-- <a href="https://youtu.be/16cejGujTSA">&raquo; View history recording in Mersorcium YouTube Channel</a> -->
    <img src="{{ "/posters/Seminar-20250602-Joao_Santos.jpg" | relative_url }}" alt="poster" />
    <a href="https://umu.zoom.us/j/67699665745">&raquo; Click here to enter the zoom meeting</a>
</div>


<!-- ðŸ’¡ Local time conversion script -->
<script>
  // Wait for DOM to fully load
  document.addEventListener('DOMContentLoaded', function() {
    try {
      const utcTime = '2025-06-02T14:00:00Z'; // UTC time of the seminar
      const userTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
      const localDate = new Date(utcTime);

      const formatted = localDate.toLocaleString('en-US', {
        timeZone: userTimeZone,
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        hour12: false
      });

      document.getElementById('seminar-time').textContent = `${formatted} (${userTimeZone})`;
    } catch (error) {
      console.error("Error in time conversion:", error);
    }
  });
</script>

<script>
  // Wait for DOM to fully load
  document.addEventListener('DOMContentLoaded', function() {
    try {
      // Seminar details
      const title = 'Online Seminar: Unveiling the role of phytoplankton species in mercury cycling transformations';
      const location = 'Zoom: https://umu.zoom.us/j/67699665745';
      const description = 'Speaker: JoÃ£o Santos\\nJoin via Zoom: https://umu.zoom.us/j/67699665745';
      
      const startUtc = new Date('2025-06-02T14:00:00Z'); // Using same UTC time as display
      const endUtc = new Date(startUtc.getTime() + 60 * 60 * 1000); // +1 hour

      // Format for Google Calendar link
      const formatDateForGCal = (date) => {
        return date.toISOString().replace(/[-:]|\.\d{3}/g, '');
      };

      const gcalLink = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${formatDateForGCal(startUtc)}/${formatDateForGCal(endUtc)}&details=${encodeURIComponent(description)}&location=${encodeURIComponent(location)}&sf=true&output=xml`;
      
      const gcalButton = document.getElementById('gcal-link');
      if (gcalButton) {
        gcalButton.href = gcalLink;
        console.log("Google Calendar link set:", gcalLink);
      } else {
        console.error("Google Calendar button not found!");
      }

      // Format for .ics file
      const pad = (num) => String(num).padStart(2, '0');
      const formatICSDate = (d) => {
        return `${d.getUTCFullYear()}${pad(d.getUTCMonth() + 1)}${pad(d.getUTCDate())}T${pad(d.getUTCHours())}${pad(d.getUTCMinutes())}00Z`;
      };

      const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Your Site//EN
BEGIN:VEVENT
UID:${Date.now()}@yourdomain.com
DTSTAMP:${formatICSDate(new Date())}
DTSTART:${formatICSDate(startUtc)}
DTEND:${formatICSDate(endUtc)}
SUMMARY:${title}
DESCRIPTION:${description}
LOCATION:${location}
END:VEVENT
END:VCALENDAR`;

      const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
      const icsURL = URL.createObjectURL(blob);
      
      const icsButton = document.getElementById('ics-download');
      if (icsButton) {
        icsButton.href = icsURL;
        console.log("ICS download link created");
      } else {
        console.error("ICS download button not found!");
      }
    } catch (error) {
      console.error("Error setting up calendar links:", error);
    }
  });
</script>

<!-- âœ¨ Optional minimal styling -->
<style>
  .seminar-time-box {
    background-color: #f3f4f6;
    border-left: 4px solid #3b82f6;
    padding: 1em;
    margin: 1em 0;
    font-family: system-ui, sans-serif;
    border-radius: 6px;
  }
    .calendar-button {
    display: inline-block;
    background-color: #718ece;
    color: white;
    padding: 0.4em 0.8em;
    margin-right: 0.5em;
    text-decoration: none;
    border-radius: 5px;
    font-size: 0.9em;
    transition: background-color 0.2s ease;
  }
  .calendar-button:hover {
    background-color: #4660b6;
  }
</style>